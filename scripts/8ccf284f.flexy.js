!function(a){"use strict";function b(b){function e(){var a=l();a!==p?(p=a,f(),r=k(p),o=[],g()):f()}function f(){var b=(a(window).width()-p*d.width)/2;1===p&&(b=0),a(n).css("transform","translateX("+b+"px)")}function g(){var b=_.clone(q,!0);4>p&&(b=_.sortBy(b,function(a){return null===a.getAttribute("data-priority")?99:a.getAttribute("data-priority")})),_.forEach(b,function(a){o.push(h(c(a)))});var e=_.max(o,function(a){return a.rowNum}).rowNum;a(d.container).css("height",(e+1)*d.height),p>1?a(d.container).css("width",p*d.width):a(d.container).css("width","auto"),_.forEach(o,function(a){j(a)}),m=!0}function h(a){var b=Number(a.col),c=Number(a.row);1===p&&(b=1);var d=i(a);a.colPos=d.colPos,a.rowNum=d.rowNum;for(var e=0;b>e;e++)for(var f=0;c>f;f++)r[f+a.rowNum][e+a.colPos]=1;return a}function i(a){function b(a,b,c){for(var e=0;d>e;e++)if(0!==a[e+b][c])return!1;return!0}var c=Number(a.col),d=Number(a.row);1===p&&(c=1);var e=0,f=0;return f=_.findIndex(r,function(a,d,f){for(var g=0;g<a.length;g+=1){var h=a.slice(g,g+c);if(!(g+c>a.length)&&-1===_.indexOf(h,1)&&b(f,d,g))return e=g,!0}}),{colPos:e,rowNum:f}}function j(b){var c=a(b.el),e=b.colPos*d.width,f=b.rowNum*d.height;Modernizr.csstransforms?m?c.css("transform","translate("+e+"px, "+f+"px"):(c.css("transform","translate("+e+"px, 1000px"),c.css("display","block"),window.setTimeout(function(){c.css("transform","translate("+e+"px, "+f+"px"),window.setTimeout(function(){c.addClass("flexy__transform-animation")},450)},250)):(c.css("left",e+"px"),c.css("top",f+"px")),c.css("height",d.height*b.row),1!==p?c.css("width",d.width*b.col):c.css("width","100%")}function k(a){for(var b=[],c=0;20>c;c++){b[c]=[];for(var d=0;a>d;d++)b[c][d]=0}return b}function l(){var a=Math.floor(b.offsetWidth/d.width);return 0===a&&(a=1),a>=4&&(a=4),a}var m=!1,n=b.querySelector(d.container),o=[],p=l(),q=n.querySelectorAll(".flexy__box--js"),r=k(p);f(),g();var s=_.debounce(e,50);return a(window).on("resize",s),o}function c(a){var b=a.getAttribute("data-col"),c=a.getAttribute("data-row");return{el:a,col:b,row:c}}var d={container:".flexy__container",width:292.5,height:300},e=document.querySelectorAll(".flexy");_.forEach(e,function(a){a=b(a),console.log("flexy: ",a)})}(jQuery);